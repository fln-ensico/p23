--import Data.Map (Map)
import qualified Data.Map as Map

-- school = aego | cnsl
data School a = AEGO a | CNSL a | ESAS a deriving Show

email (ESAS s) t = map (r . snd) (filter (\x -> fst x == t) s) where r = Map.map (\x -> show x ++ "@aesmi.pt")
email (CNSL s) t = map (r . snd) (filter (\x -> fst x == t) s) where r = Map.map (\x -> show x ++ "@cnslourdes.com")
email (AEGO s) t = map (r . snd) (filter (\x -> fst x == t) s) where r = Map.map (\x -> show x ++ "@aegarciadeorta.pt")
email (AEMO s) t = map (r . snd) (filter (\x -> fst x == t) s) where r = Map.map (\x -> show x ++ "@avmanoeloliveira.pt")

email' s t = concat $ map (++";\n") $ concat $ map Map.elems (email s t)

main' s t = putStrLn $ email' s t

cnsl_done = ["5A","5B","5C","9A","9B","9C"]

cnsl = CNSL [
    ("3A",Map.fromList (zip [1..19] cnsl3A)),
    ("3B",Map.fromList (zip [1..20] cnsl3B)),
    ("3C",Map.fromList (zip [1..19] cnsl3C)),
    ("5A",Map.fromList (zip [1..25] cnsl5A)),
    ("5B",Map.fromList (zip [1..25] cnsl5B)),
    ("5C",Map.fromList (zip [1..24] cnsl5C)),
    ("9A",Map.fromList (zip [1..21] cnsl9A)),
    ("9B",Map.fromList (zip [1..23] cnsl9B)),
    ("9C",Map.fromList (zip [1..22] cnsl9C))]
    where cnsl3A = [20190015,
                    20150016,
                    20160038,
                    20190133,
                    20150019,
                    20140001,
                    20150070,
                    20190007,
                    20160046,
                    20160024,
                    20180110,
                    20190002,
                    20180031,
                    20210106,
                    20190134,
                    20130041,
                    20160015,
                    20170139,
                    20190077]
          cnsl3B = [2015006,
                    2019006,
                    2017001,
                    2019001,
                    2015008,
                    2020007,
                    2014004,
                    2017010,
                    2019005,
                    2018012,
                    2017010,
                    2014009,
                    2014007,
                    2020011,
                    2014000,
                    2019000,
                    2019006,
                    2014008,
                    2014000,
                    2017013]
          cnsl3C =Â [2019010,
                    2019013,
                    2019007,
                    2016004,
                    2016000,
                    2019004,
                    2017006,
                    2017000,
                    2017001,
                    2014006,
                    2014007,
                    2015004,
                    2019001,
                    2017011,
                    2020002,
                    2019013,
                    2016000,
                    2013012,
                    2015010]
          cnsl5A = [20170120,
                    20130005,
                    20210046,
                    20140016,
                    20180101,
                    20210017,
                    20130108,
                    20180103,
                    20170019,
                    20130105,
                    20210032,
                    20170073,
                    20210097,
                    20140027,
                    20130081,
                    20140053,
                    20170016,
                    20210026,
                    20120090,
                    20130071,
                    20130007,
                    20140043,
                    20210029,
                    20190138,
                    20160072]
          cnsl5B = [20210045,
                    20140049,
                    20210051,
                    20170017,
                    20120030,
                    20210021,
                    20140075,
                    20210049,
                    20200072,
                    20210052,
                    20170087,
                    20120040,
                    20140022,
                    20170005,
                    20140036,
                    20130014,
                    20170057,
                    20140057,
                    20210108,
                    20200098,
                    20180095,
                    20170114,
                    20210036,
                    20140023,
                    20210107]
          cnsl5C = [20130051,
                    20150080,
                    20190057,
                    20170137,
                    20170028,
                    20200108,
                    20170123,
                    20170124,
                    20210113,
                    20180081,
                    20140069,
                    20130097,
                    20210102,
                    20140039,
                    20120016,
                    20140029,
                    20190054,
                    20200064,
                    20210092,
                    20120098,
                    20110140,
                    20140102,
                    20210086,
                    20190111]
          cnsl9A = [20130018,
                    20120039,
                    20170031,
                    20110059,
                    20100058,
                    20170015,
                    20130017,
                    20090021,
                    20130022,
                    20170020,
                    20170130,
                    20130052,
                    20120055,
                    20170066,
                    20110110,
                    20090006,
                    20100052,
                    20130036,
                    20130023,
                    20130047,
                    20130020]
          cnsl9B = [20130019,
                    20170069,
                    20090113,
                    20100030,
                    20100110,
                    20170035,
                    20120073,
                    20170007,
                    20170024,
                    20130100,
                    20170038,
                    20100071,
                    20170077,
                    20170056,
                    20210101,
                    20170058,
                    20090032,
                    20110091,
                    20130094,
                    20170125,
                    20130067,
                    20200076,
                    20090001]
          cnsl9C = [20090003,
                    20130044,
                    20100049,
                    20110137,
                    20090039,
                    20190075,
                    20100035,
                    20090071,
                    20130021,
                    20130056,
                    20100076,
                    20170011,
                    20120047,
                    20130026,
                    20090107,
                    20130054,
                    20090016,
                    20130103,
                    20200065,
                    20190148,
                    20170088,
                    20170140]

aego_done = ["5A","5B","5C","5D","5E","5F","5G","5H","5I","7C","8J"]

aego = AEGO [
    ("5A",Map.fromList
    [(1,20865),
        (2,21497),
        (3,21494),
        (4,20591),
        (5,23211),
        (6,20571),
        (7,21498),
        (8,21261),
        (9,23212),
        (10,21372),
        (11,21359),
        (12,19863),
        (13,20573),
        (14,19872),
        (15,20553),
        (16,21357),
        (17,20592),
        (18,20519),
        (19,23213),
        (20,21366)]),
    ("5B",Map.fromList
    [(1,23214),
        (2,20891),
        (3,23215),
        (4,20504),
        (5,20570),
        (6,19879),
        (7,20541),
        (8,20509),
        (9,20046),
        (10,23216),
        (11,19924),
        (12,20569),
        (13,21502),
        (14,20542),
        (15,20881),
        (16,20877),
        (17,21481),
        (18,20503),
        (19,20048),
        (20,20175)]),
    ("5C",Map.fromList
    [(1,23232),
        (2,23217),
        (3,21385),
        (4,23219),
        (5,23218),
        (6,20587),
        (7,23220),
        (8,20529),
        (9,21360),
        (10,23288),
        (11,23221),
        (12,23222),
        (13,21374),
        (14,23223),
        (15,21387),
        (16,19364),
        (17,22937),
        (18,20148),
        (19,20821),
        (20,21370),
        (21,22873),
        (22,23224),
        (23,23225),
        (24,23227),
        (25,23226)]),
    ("5D",Map.fromList
    [(1,19911),
        (2,21379),
        (3,23228),
        (4,19888),
        (5,22936),
        (6,20828),
        (7,21492),
        (8,20909),
        (9,21369),
        (10,19905),
        (11,23234),
        (12,23229),
        (13,21388),
        (14,20864),
        (15,20862),
        (16,20094),
        (17,20863),
        (18,23230),
        (19,20889),
        (20,20562),
        (21,23235),
        (22,20516),
        (23,21129),
        (24,20601),
        (25,20823),
        (26,23231)]),
    ("5E",Map.fromList
    [(1,21490),
        (2,20154),
        (3,21381),
        (4,20596),
        (5,23233),
        (6,21488),
        (7,21358),
        (8,21368),
        (9,21483),
        (10,20531),
        (11,20896),
        (12,21364),
        (13,21384),
        (14,21130),
        (15,21489),
        (16,23237),
        (17,21371),
        (18,21382),
        (19,23305),
        (20,20913)]),
    ("5F",Map.fromList
    [(1,20055),
        (2,19929),
        (3,22908),
        (4,19901),
        (5,20527),
        (6,23264),
        (7,23259),
        (8,23265),
        (9,23266),
        (10,23267),
        (11,23260),
        (12,23261),
        (13,21477),
        (14,20576),
        (15,20902),
        (16,20543),
        (17,20873),
        (18,23268),
        (19,23270),
        (20,20548),
        (21,20910),
        (22,19942),
        (23,23247),
        (24,23269),
        (25,20908),
        (26,23262)]),
    ("5G",Map.fromList
    [(1,20579),
        (2,21216),
        (3,21377),
        (4,23251),
        (5,23250),
        (6,21375),
        (7,21501),
        (8,23252),
        (9,23253),
        (10,19939),
        (11,21361),
        (12,21493),
        (13,21389),
        (14,23254),
        (15,19949),
        (16,20545),
        (17,23255),
        (18,23236),
        (19,19876),
        (20,19919),
        (21,21496),
        (22,21373),
        (23,21362),
        (24,21365),
        (25,19940),
        (26,21486)]),
    ("5H",Map.fromList
    [(1,23238),
        (2,23239),
        (3,20912),
        (4,20506),
        (5,21491),
        (6,19871),
        (7,20515),
        (8,23240),
        (9,23241),
        (10,20890),
        (11,21380),
        (12,21376),
        (13,20522),
        (14,21484),
        (15,22883),
        (16,23242),
        (17,23243),
        (18,23244),
        (19,23245),
        (20,21136),
        (21,23246),
        (22,19916),
        (23,21383),
        (24,23248),
        (25,20913),
        (26,23249)]),
    ("5I",Map.fromList
    [(1,21485),
        (2,20595),
        (3,20498),
        (4,23256),
        (5,19913),
        (6,21499),
        (7,23257),
        (8,19897),
        (9,23258),
        (10,22452),
        (11,19864),
        (12,21487),
        (13,21478),
        (14,19895),
        (15,21479),
        (16,19890),
        (17,22023),
        (18,20550),
        (19,19870),
        (20,19917),
        (21,19894),
        (22,21476),
        (23,20604),
        (24,20870)]),
    ("7C",Map.fromList
    [(1,18883),
        (2,22227),
        (3,20651),
        (4,18869),
        (5,18857),
        (6,19337),
        (7,22514),
        (8,20649),
        (9,22228),
        (10,19376),
        (11,19350),
        (12,22229),
        (13,20626),
        (14,18887),
        (15,20630),
        (16,20009),
        (17,20643),
        (18,20628),
        (19,18871),
        (20,20669),
        (21,23331)]),
    ("8J",Map.fromList
    [(1,21777),
        (2,19297),
        (3,12837),
        (4,20177),
        (5,13314),
        (6,18922),
        (7,22036),
        (8,19400),
        (9,13384),
        (10,18881),
        (11,13327),
        (12,19972),
        (13,22788),
        (14,22538),
        (15,22531),
        (16,13441),
        (17,21788),
        (18,22061),
        (19,22005),
        (20,22541),
        (21,18889),
        (22,21790),
        (23,21793),
        (24,19305),
        (25,21791),
        (26,21789),
        (27,19340),
        (28,13312)])]

vilarinha_done = ["4A"]

vilarinha = AEMO [
    ("4A",Map.fromList (zip [1..19] aemo4A)),
    ("4B",Map.fromList (zip [1..22] aemo4B))]
    where aemo4A = [16403,
                    16821,
                    16311,
                    16601,
                    16605,
                    16384,
                    16404,
                    16294,
                    16839,
                    15976,
                    16612,
                    16399,
                    16602,
                    16394,
                    17191,
                    16380,
                    16312,
                    16528,
                    16852,
                    16401,
                    16288,
                    16617,
                    16614,
                    16307],
          aemo4B = []
